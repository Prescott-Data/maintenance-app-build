"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[6544,7058,2380,3697,7670,1215],{36317:function(e,t,n){n.r(t),n.d(t,{Component:function(){return v}});var l=n(5292),a=n(28014),r=n(90591),i=n(6866),o=n(72176),m=n(50445),s=n(14571),c=n(87899),u=n(49394),d=n(16680),E=n(16757),g=n(39614),f=n(17058),p=n(66920);const{Form:h}=(0,m.mz)(),b=`/${(0,d.HR)(d.Vr.dataElement)}`;const v=()=>{var e;const t=(0,d.Qn)(),n=(0,s.g)().id,r=function(e){const t={dataElement:{resource:`dataElements/${e}`,params:{fields:["*","attributeValues[*]"]}}};return(0,l.iO)(t,{variables:{id:e}})}(n),m=(0,u.yZ)(),f=function(){const e=(0,l.ow)();return async t=>{let{values:n,dirtyFields:l,dataElement:a}=t;const r=(0,E.P)({values:n,dirtyFields:l,originalValue:a}),o={resource:"dataElements",id:n.id,type:"json-patch",data:e=>{let{operations:t}=e;return t}};try{await e.mutate(o,{variables:{operations:r}})}catch(m){return{[i.Ym]:m.toString()}}}}();const v=function(e){var t,n;let{dataElementId:l,dataElement:a,customAttributes:r}=e;if(!a)return{};const i=(0,g.W)(a.attributeValues,r);return{id:l,name:a.name,shortName:a.shortName,code:a.code,description:a.description,url:a.url,style:{color:null===(t=a.style)||void 0===t?void 0:t.color,icon:null===(n=a.style)||void 0===n?void 0:n.icon},fieldMask:a.fieldMask,domainType:a.domainType,formName:a.formName,valueType:a.valueType,aggregationType:a.aggregationType,categoryCombo:a.categoryCombo||{id:""},optionSet:a.optionSet||{id:""},commentOptionSet:a.commentOptionSet||{id:""},legendSets:a.legendSets||[],aggregationLevels:a.aggregationLevels||[],zeroIsSignificant:a.zeroIsSignificant,attributeValues:i}}({dataElementId:n,dataElement:null===(e=r.data)||void 0===e?void 0:e.dataElement,customAttributes:m.data||[]});return o.createElement(c.aH,{queryResponse:r,label:a.A.t("Data element")},o.createElement(c.aH,{queryResponse:m,label:a.A.t("Custom attributes")},o.createElement(h,{validateOnBlur:!0,onSubmit:async function(e,n){var l;const a=await f({values:e,dirtyFields:n.getState().dirtyFields,dataElement:null===(l=r.data)||void 0===l?void 0:l.dataElement});if(a)return a;t(b)},validate:e=>(0,d.tf)(p.dataElementSchema,e),initialValues:v},(e=>{let{handleSubmit:t,submitting:n,submitError:l}=e;return o.createElement("form",{onSubmit:t},o.createElement(y,{submitError:l,submitting:n}))}))))};function y(e){let{submitError:t,submitting:n}=e;const l=(0,o.useRef)(null),i=(0,d.Qn)();return(0,o.useEffect)((()=>{var e;t&&(null===(e=l.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[t]),o.createElement(o.Fragment,null,t&&o.createElement(c.Hl,null,o.createElement("div",{ref:l},o.createElement(r.I,{error:!0,title:a.A.t("Something went wrong when submitting the form")},t))),o.createElement("div",{className:f.default.form},o.createElement(p.DataElementFormFields,null)),o.createElement("div",{className:f.default.formActions},o.createElement(c.Hn,{cancelLabel:a.A.t("Cancel"),submitLabel:a.A.t("Save and close"),submitting:n,onCancelClick:()=>i(b)})))}},84235:function(e,t,n){n.r(t),n.d(t,{DataElementFormFields:function(){return s}});var l=n(28014),a=n(72176),r=n(87899),i=n(49394),o=n(16680),m=n(37591);function s(){const e=o.Vr.dataElement;return a.createElement(a.Fragment,null,a.createElement(r.Hl,null,a.createElement(r.L7,null,l.A.t("Basic information")),a.createElement(r.hK,null,l.A.t("Set up the information for this data element")),a.createElement(r.Ys,null,a.createElement(i.om,{schemaSection:e})),a.createElement(r.Ys,null,a.createElement(i.Uu,{schemaSection:e})),a.createElement(r.Ys,null,a.createElement(m.FormNameField,null)),a.createElement(r.Ys,null,a.createElement(i.Ij,{schemaSection:e})),a.createElement(r.Ys,null,a.createElement(i.zO,{helpText:l.A.t("Explain the purpose of this data element."),schemaSection:e})),a.createElement(r.Ys,null,a.createElement(m.UrlField,null)),a.createElement(r.Ys,null,a.createElement(m.ColorAndIconField,null)),a.createElement(r.Ys,null,a.createElement(m.FieldMaskField,null)),a.createElement(r.Ys,null,a.createElement(m.ZeroIsSignificantField,null)),a.createElement(r.Ys,null,a.createElement(m.DomainField,null)),a.createElement(r.Ys,null,a.createElement(m.ValueTypeField,null)),a.createElement(r.Ys,null,a.createElement(m.AggregationTypeField,null))),a.createElement(r.Hl,null,a.createElement(r.L7,null,l.A.t("Disaggregation and Option sets")),a.createElement(r.hK,null,l.A.t("Set up disaggregation and predefined options.")),a.createElement(r.Ys,null,a.createElement(m.CategoryComboField,null)),a.createElement(r.Ys,null,a.createElement(m.OptionSetField,null)),a.createElement(r.Ys,null,a.createElement(m.OptionSetCommentField,null))),a.createElement(r.Hl,null,a.createElement(r.L7,null,l.A.t("Legend set")),a.createElement(r.hK,null,l.A.t("Visualize values for this data element in Analytics app. Multiple legendSet can be applied.")),a.createElement(r.Ys,null,a.createElement(m.LegendSetField,null))),a.createElement(r.Hl,null,a.createElement(r.L7,null,l.A.t("Aggregation levels")),a.createElement(r.hK,null,l.A.t('By default, the aggregation will start at the lowest assigned organisation unit. If you for example select "Chiefdom", it means that "Chiefdom", "District" and "National" aggregates use "Chiefdom" (the highest aggregation level available) as the data source, and PHU data will not be included. PHU will still be available for the PHU level, but not included in the aggregations to the levels above.')),a.createElement(r.Ys,null,a.createElement(m.AggregationLevelsField,null))),a.createElement(r.Ot,{schemaSection:e}))}},41215:function(e,t,n){n.r(t),n.d(t,{dataElementSchema:function(){return a}});var l=n(73044);const a=l.z.object({name:l.z.string().trim(),shortName:l.z.string().trim(),code:l.z.string().trim(),description:l.z.string().trim(),formName:l.z.string().trim(),url:l.z.string().trim(),fieldMask:l.z.string().trim(),style:l.z.object({color:l.z.string().optional(),icon:l.z.string().optional()}),domainType:l.z.union([l.z.literal("AGGREGATE"),l.z.literal("TRACKER")]),valueType:l.z.string(),aggregationType:l.z.string(),optionSet:l.z.object({id:l.z.string()}),commentOptionSet:l.z.object({id:l.z.string()}),legendSets:l.z.array(l.z.object({id:l.z.string()})),aggregationLevels:l.z.array(l.z.number()),attributeValues:l.z.array(l.z.object({value:l.z.string().optional(),attribute:l.z.object({id:l.z.string()})}))}).partial()},66920:function(e,t,n){n.r(t),n.d(t,{DataElementFormFields:function(){return l.DataElementFormFields},dataElementSchema:function(){return a.dataElementSchema}});var l=n(84235),a=n(41215)},17058:function(e,t,n){n.r(t),t.default={form:"Edit_form__bKt93",formActions:"Edit_formActions__y4qQF"}}}]);
//# sourceMappingURL=6544.d3f82546.chunk.js.map