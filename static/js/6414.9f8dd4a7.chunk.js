"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[6414,6827,3617],{26414:function(e,t,a){a.r(t),a.d(t,{CategoriesField:function(){return p}});var r=a(28014),o=a(24394),i=a(90591),l=a(72176),n=a(50445),s=a(14571),c=a(75204),d=a(87899),m=a(36827),g=a(53617);const u={resource:"categories",params:{fields:["id","displayName","categoryOptions~size~rename(categoryOptionsSize)"],order:"displayName:asc",filter:["name:ne:default"]}},C="categories",y=new Intl.NumberFormat;function p(){var e,t,a;const c=null===(e=(0,s.g)())||void 0===e?void 0:e.id,{input:g,meta:p}=(0,n.Mt)(C,{multiple:!0,validateFields:[]}),b=(null===(t=g.value)||void 0===t?void 0:t.reduce(((e,t)=>e*t.categoryOptionsSize),1))||0;return l.createElement("div",{className:m.default.categoriesFieldWrapper},l.createElement(o.D,{dataTest:"formfields-modeltransfer",error:p.invalid,validationText:p.touched&&(null===(a=p.error)||void 0===a?void 0:a.toString())||"",name:C},l.createElement(d.tW,{selected:g.value,onChange:e=>{let{selected:t}=e;g.onChange(t),g.onBlur()},leftHeader:r.A.t("Available categories"),rightHeader:r.A.t("Selected categories"),filterPlaceholder:r.A.t("Filter available categories"),filterPlaceholderPicked:r.A.t("Filter selected categories"),query:u,maxSelections:200})),l.createElement("div",{className:m.default.categoriesNoticesWrapper},!c&&b>1&&l.createElement(i.I,{warning:b>250},r.A.t("{{count}} category option combinations will be generated.",{count:y.format(b)})),l.createElement(h,{catComboId:c,selectedCategories:g.value})))}const h=e=>{var t;let{selectedCategories:a,catComboId:o}=e;const n=a.length>4,s=(0,g.useIdenticalCategoryCombosQuery)({categoryComboId:o,selectedCategories:a,enabled:!n}),c=s.isSuccess&&(null===(t=s.data)||void 0===t?void 0:t.pager.total)>0;return n||c?l.createElement(l.Fragment,null,c&&l.createElement(b,{categoryCombos:s.data.categoryCombos}),n&&l.createElement(i.I,{warning:!0,title:r.A.t("More than 4 Categories")},r.A.t("A Category combination with more than 4 categories is not recommended."))):null},b=e=>{let{categoryCombos:t}=e;return l.createElement(i.I,{warning:!0,title:r.A.t("Identical Category Combination")},r.A.t("One or more Category combinations with the same categories already exist in the system. \n        It is strongly discouraged to have more than one Category combination with the same categories."),l.createElement("br",null),r.A.t("The following Category combinations have identical categories:"),l.createElement("ul",{className:m.default.identicalCategoriesList},t.map((e=>l.createElement("li",{key:e.id},l.createElement(c.k2,{target:"_blank",to:`../${e.id}`},e.displayName))))))}},53617:function(e,t,a){a.r(t),a.d(t,{useIdenticalCategoryCombosQuery:function(){return i}});var r=a(84586),o=a(27648);const i=e=>{let{categoryComboId:t,selectedCategories:a,...i}=e;const l=(0,o.sf)(),n=`id:ne:${t}`,s=a.map((e=>`categories.id:eq:${e.id}`)),c=[`categories:eq:${a.length}`,...s];t&&c.push(n);const d={resource:"categoryCombos",params:{fields:["id","displayName"],filter:c}};return(0,r.useQuery)({staleTime:6e4,...i,queryKey:[d],queryFn:l})}},36827:function(e,t,a){a.r(t),t.default={categoriesFieldWrapper:"CategoryCombo_categoriesFieldWrapper__00djY",categoriesNoticesWrapper:"CategoryCombo_categoriesNoticesWrapper__R4Myf",identicalCategoriesList:"CategoryCombo_identicalCategoriesList__chLzG"}}}]);
//# sourceMappingURL=6414.9f8dd4a7.chunk.js.map