{"version":3,"file":"static/js/8728.983ee130.chunk.js","mappings":"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","sources":["D2App/components/form/fields/DateField.js","D2App/pages/categoryOptions/Edit.js","D2App/pages/categoryOptions/form/CategoryOptionFormFields.js","D2App/pages/categoryOptions/form/categoryOptionSchema.js"],"sourcesContent":["function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport i18n from '@dhis2/d2-i18n';\nimport { CalendarInput } from '@dhis2/ui';\nimport React, { useState } from 'react';\nimport { useField } from 'react-final-form';\nimport { selectedLocale, useSystemSetting } from '../../../lib';\nexport function DateField(_ref) {\n  let {\n    name,\n    label,\n    required,\n    ...calendarInputProps\n  } = _ref;\n  const calendar = useSystemSetting('keyCalendar');\n  const locale = selectedLocale;\n  const [validation, setValidation] = useState({\n    error: false,\n    valid: true\n  });\n  const {\n    input\n  } = useField(name, {\n    format: value => value ? value.substring(0, 10) : ''\n  });\n  const handleChange = payload => {\n    if (!(payload !== null && payload !== void 0 && payload.calendarDateString) && required) {\n      setValidation({\n        error: true,\n        valid: false,\n        validationCode: 'EMPTY',\n        validationText: i18n.t('Required')\n      });\n    } else {\n      setValidation((payload === null || payload === void 0 ? void 0 : payload.validation) || {\n        error: false,\n        valid: true\n      });\n    }\n    input.onChange((payload === null || payload === void 0 ? void 0 : payload.calendarDateString) || '');\n    input.onBlur();\n  };\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(CalendarInput, _extends({\n    inputWidth: '400px',\n    date: input.value,\n    name: name,\n    required: required,\n    calendar: calendar,\n    onDateSelect: handleChange,\n    timeZone: 'utc',\n    locale: locale,\n    format: 'YYYY-MM-DD',\n    onBlur: (_, e) => input.onBlur(e),\n    clearable: true,\n    label: required ? `${label} (required)` : label\n  }, validation, {\n    valid: (validation === null || validation === void 0 ? void 0 : validation.valid) && (input === null || input === void 0 ? void 0 : input.value) !== ''\n  }, calendarInputProps)));\n}","import React from 'react';\nimport { useQuery } from 'react-query';\nimport { useParams } from 'react-router-dom';\nimport { DefaultEditFormContents, FormBase } from '../../components';\nimport { ATTRIBUTE_VALUES_FIELD_FILTERS, DEFAULT_FIELD_FILTERS, SECTIONS_MAP, useOnSubmitEdit } from '../../lib';\nimport { useBoundResourceQueryFn } from '../../lib/query/useBoundQueryFn';\nimport { validate, CategoryOptionFormFields } from './form';\nconst fieldFilters = [...DEFAULT_FIELD_FILTERS, ...ATTRIBUTE_VALUES_FIELD_FILTERS, 'name', 'formName', 'code', 'shortName', 'description', 'startDate', 'endDate', 'organisationUnits[id,displayName,path]'];\nconst section = SECTIONS_MAP.categoryOption;\nexport const Component = () => {\n  const queryFn = useBoundResourceQueryFn();\n  const modelId = useParams().id;\n  const query = {\n    resource: 'categoryOptions',\n    id: modelId,\n    params: {\n      fields: fieldFilters.concat()\n    }\n  };\n  const categoryOptionCombo = useQuery({\n    queryKey: [query],\n    queryFn: queryFn\n  });\n  return /*#__PURE__*/React.createElement(FormBase, {\n    onSubmit: useOnSubmitEdit({\n      section,\n      modelId\n    }),\n    section: section,\n    initialValues: categoryOptionCombo.data,\n    validate: validate\n  }, /*#__PURE__*/React.createElement(DefaultEditFormContents, {\n    section: section\n  }, /*#__PURE__*/React.createElement(CategoryOptionFormFields, null)));\n};","import i18n from '@dhis2/d2-i18n';\nimport { InputFieldFF } from '@dhis2/ui';\nimport React from 'react';\nimport { Field } from 'react-final-form';\nimport { CustomAttributesSection, DefaultIdentifiableFields, DescriptionField, OrganisationUnitField, StandardFormField, StandardFormSection, StandardFormSectionDescription, StandardFormSectionTitle } from '../../../components';\nimport { DateField } from '../../../components/form/fields/DateField';\nimport { SECTIONS_MAP } from '../../../lib';\nconst section = SECTIONS_MAP.categoryOption;\nexport const CategoryOptionFormFields = () => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(StandardFormSection, null, /*#__PURE__*/React.createElement(StandardFormSectionTitle, null, i18n.t('Basic information')), /*#__PURE__*/React.createElement(StandardFormSectionDescription, null, i18n.t('Set up the basic information for this category option.')), /*#__PURE__*/React.createElement(DefaultIdentifiableFields, null), /*#__PURE__*/React.createElement(StandardFormField, null, /*#__PURE__*/React.createElement(Field, {\n    component: InputFieldFF,\n    dataTest: \"formfields-formname\",\n    inputWidth: \"400px\",\n    name: \"formName\",\n    label: i18n.t('Form name'),\n    helpText: i18n.t('An alternative name used in section or automatic data entry forms.'),\n    validateFields: []\n  })), /*#__PURE__*/React.createElement(StandardFormField, null, /*#__PURE__*/React.createElement(DescriptionField, {\n    schemaSection: section\n  }))), /*#__PURE__*/React.createElement(StandardFormSection, null, /*#__PURE__*/React.createElement(StandardFormSectionTitle, null, i18n.t('Availability configuration')), /*#__PURE__*/React.createElement(StandardFormSectionDescription, null, i18n.t('Choose when, and for which organisation units this category option will be available.')), /*#__PURE__*/React.createElement(StandardFormField, null, /*#__PURE__*/React.createElement(DateField, {\n    name: \"startDate\",\n    label: \"Pick a start date\"\n  })), /*#__PURE__*/React.createElement(StandardFormField, null, /*#__PURE__*/React.createElement(DateField, {\n    name: \"endDate\",\n    label: \"Pick an end date\"\n  })), /*#__PURE__*/React.createElement(StandardFormField, null, /*#__PURE__*/React.createElement(OrganisationUnitField, null))), /*#__PURE__*/React.createElement(CustomAttributesSection, {\n    schemaSection: section\n  }));\n};","import i18n from '@dhis2/d2-i18n';\nimport { z } from 'zod';\nimport { getDefaults, modelFormSchemas } from '../../../lib';\nimport { createFormValidate } from '../../../lib/form/validate';\nconst {\n  withAttributeValues,\n  identifiable,\n  referenceCollection\n} = modelFormSchemas;\nexport const categoryOptionSchema = identifiable.merge(withAttributeValues).extend({\n  code: z.string().trim().optional(),\n  shortName: z.string().trim(),\n  formName: z.string().trim().max(230, {\n    message: i18n.t('Form name should not exceed 230 characters')\n  }).optional(),\n  description: z.string().trim().optional(),\n  startDate: z.coerce.date().optional(),\n  endDate: z.coerce.date().optional(),\n  organisationUnits: referenceCollection.optional()\n}).refine(data => {\n  if (data.startDate && data.endDate) {\n    return data.startDate <= data.endDate;\n  }\n  return true;\n}, {\n  message: i18n.t('End date should be after start date'),\n  path: ['endDate']\n});\nexport const initialValues = getDefaults(categoryOptionSchema);\nexport const validate = createFormValidate(categoryOptionSchema);"],"names":["_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","DateField","_ref","name","label","required","calendarInputProps","calendar","useSystemSetting","locale","selectedLocale","validation","setValidation","useState","error","valid","input","useField","format","value","substring","React","CalendarInput","inputWidth","date","onDateSelect","payload","calendarDateString","validationCode","validationText","i18n","onChange","onBlur","timeZone","_","clearable","fieldFilters","DEFAULT_FIELD_FILTERS","ATTRIBUTE_VALUES_FIELD_FILTERS","section","SECTIONS_MAP","categoryOption","Component","queryFn","useBoundResourceQueryFn","modelId","useParams","id","query","resource","params","fields","concat","categoryOptionCombo","useQuery","queryKey","FormBase","onSubmit","useOnSubmitEdit","initialValues","data","validate","DefaultEditFormContents","CategoryOptionFormFields","StandardFormSection","StandardFormSectionTitle","StandardFormSectionDescription","DefaultIdentifiableFields","StandardFormField","Field","component","InputFieldFF","dataTest","helpText","validateFields","DescriptionField","schemaSection","OrganisationUnitField","CustomAttributesSection","withAttributeValues","identifiable","referenceCollection","modelFormSchemas","categoryOptionSchema","merge","extend","code","z","string","trim","optional","shortName","formName","max","message","description","startDate","coerce","endDate","organisationUnits","refine","path","getDefaults","createFormValidate"],"sourceRoot":""}