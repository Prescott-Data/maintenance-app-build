(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[1787,6181],{56181:function(e,t,a){"use strict";a.r(t),a.d(t,{AggregationTypeField:function(){return p}});var n=a(28014),i=a(40377),s=a(72176),l=a(50445),o=a(16680);const r=["TEXT","LONG_TEXT","MULTI_TEXT","LETTER","PHONE_NUMBER","EMAIL","TRACKER_ASSOCIATE","USERNAME","FILE_RESOURCE","COORDINATE"],c=n.A.t("The default way to aggregate this data element in analytics."),d=n.A.t("Disabled for the selected value type.");function p(){var e;const{change:t}=(0,l.mN)(),a=(0,l.Mt)("valueType").input.value,p=r.includes(a);(0,s.useEffect)((()=>{p&&t("aggregationType","NONE")}),[t,p]);const{dataElement:u}=(0,o.Ip)(),T=(null===(e=u.properties.aggregationType.constants)||void 0===e?void 0:e.map((e=>({value:e,label:o.sS[e]}))))||[],g=p?`${c} ${d}`:c;return s.createElement(l.D0,{disabled:p,component:i.T,dataTest:"formfields-aggregationtype",required:!p,inputWidth:"400px",name:"aggregationType",label:p?n.A.t("Aggregation type"):n.A.t("{{fieldLabel}} (required)",{fieldLabel:n.A.t("Aggregation type")}),helpText:g,options:T,validateFields:[],validate:o.mw})}},32071:function(e,t,a){"use strict";a.r(t);var n=a(51594),i=a(72176),s=a(50445),l=a(16680),o=a(56181);const r=Object.keys(l.sS);jest.mock("../../../lib/schemas/schemaStore",(()=>({...jest.requireActual("../../../lib/schemas/schemaStore"),useSchemas:jest.fn()}))),describe("<AggregationTypeField />",(()=>{l.Ip.mockImplementation((()=>({dataElement:{properties:{aggregationType:{constants:r}}}})));const e=["TEXT","LONG_TEXT","MULTI_TEXT","LETTER","PHONE_NUMBER","EMAIL","TRACKER_ASSOCIATE","USERNAME","FILE_RESOURCE","COORDINATE"],t=[...r.filter((t=>!e.includes(t))).map((e=>[e,!1])),...e.map((e=>[e,!0]))];describe.each(t)("disabled should be $disabled for $aggregationType",((e,t)=>{test(`should be ${t?"disabled":"enabled"} for valueType ${e}`,(async()=>{const a={valueType:e,aggregationType:"SUM"},l=(0,n.XX)(i.createElement(s.lV,{onSubmit:jest.fn(),initialValues:a},(e=>{let{handleSubmit:t}=e;return i.createElement("form",{onSubmit:t},i.createElement(o.AggregationTypeField,null))}))),r=await l.findByTestId("dhis2-uicore-select-input");expect(r.classList.contains("disabled")).toBe(t);const c=l.queryByText("Sum");t?expect(c).toBeFalsy():expect(c).toBeTruthy()}))}))}))},86973:function(){}}]);
//# sourceMappingURL=1787.d4e02d21.chunk.js.map